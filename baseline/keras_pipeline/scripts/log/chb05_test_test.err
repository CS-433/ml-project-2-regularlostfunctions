2023-12-17 18:03:31.630651: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-12-17 18:03:34.909114: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Creating Test Data Generator...
  0%|          | 0/2 [00:00<?, ?it/s] 50%|█████     | 1/2 [00:07<00:07,  7.11s/it]100%|██████████| 2/2 [00:14<00:00,  7.15s/it]100%|██████████| 2/2 [00:14<00:00,  7.14s/it]
Evaluating best model with the test set -> gru_best_epoch_0000_0.9308.h5
Loading the model...
2023-12-17 18:03:55.718536: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1960] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
Testing the model with the test signals...
  0%|          | 0/221 [00:00<?, ?it/s]  0%|          | 1/221 [00:04<15:55,  4.35s/it]  1%|          | 2/221 [00:08<15:07,  4.15s/it]  1%|▏         | 3/221 [00:11<14:11,  3.91s/it]  2%|▏         | 4/221 [00:15<14:01,  3.88s/it]  2%|▏         | 5/221 [00:19<13:52,  3.86s/it]  3%|▎         | 6/221 [00:23<13:43,  3.83s/it]  3%|▎         | 7/221 [00:27<13:25,  3.77s/it]  4%|▎         | 8/221 [00:30<13:24,  3.78s/it]  4%|▍         | 9/221 [00:34<13:29,  3.82s/it]  5%|▍         | 10/221 [00:38<13:08,  3.74s/it]  5%|▍         | 11/221 [00:41<13:00,  3.71s/it]  5%|▌         | 12/221 [00:45<13:03,  3.75s/it]  6%|▌         | 13/221 [00:49<12:53,  3.72s/it]  6%|▋         | 14/221 [00:53<12:50,  3.72s/it]  7%|▋         | 15/221 [00:57<13:13,  3.85s/it]  7%|▋         | 16/221 [01:01<13:14,  3.87s/it]  8%|▊         | 17/221 [01:05<13:26,  3.95s/it]  8%|▊         | 18/221 [01:09<13:11,  3.90s/it]  9%|▊         | 19/221 [01:13<13:12,  3.93s/it]  9%|▉         | 20/221 [01:16<13:03,  3.90s/it] 10%|▉         | 21/221 [01:21<13:09,  3.95s/it] 10%|▉         | 22/221 [01:24<13:03,  3.94s/it] 10%|█         | 23/221 [01:29<13:06,  3.97s/it] 11%|█         | 24/221 [01:33<13:16,  4.04s/it] 11%|█▏        | 25/221 [01:37<12:59,  3.98s/it] 12%|█▏        | 26/221 [01:40<12:42,  3.91s/it] 12%|█▏        | 27/221 [01:44<12:30,  3.87s/it] 13%|█▎        | 28/221 [01:48<12:16,  3.82s/it] 13%|█▎        | 29/221 [01:52<12:22,  3.87s/it] 14%|█▎        | 30/221 [01:56<12:24,  3.90s/it] 14%|█▍        | 31/221 [02:00<12:16,  3.88s/it] 14%|█▍        | 32/221 [02:03<12:07,  3.85s/it] 15%|█▍        | 33/221 [02:07<12:14,  3.90s/it] 15%|█▌        | 34/221 [02:11<12:02,  3.87s/it] 16%|█▌        | 35/221 [02:15<11:58,  3.86s/it] 16%|█▋        | 36/221 [02:19<11:54,  3.86s/it] 17%|█▋        | 37/221 [02:22<11:37,  3.79s/it] 17%|█▋        | 38/221 [02:26<11:39,  3.82s/it] 18%|█▊        | 39/221 [02:30<11:44,  3.87s/it] 18%|█▊        | 40/221 [02:35<11:58,  3.97s/it] 19%|█▊        | 41/221 [02:39<12:02,  4.01s/it] 19%|█▉        | 42/221 [02:43<11:52,  3.98s/it] 19%|█▉        | 43/221 [02:47<11:45,  3.96s/it] 20%|█▉        | 44/221 [02:50<11:38,  3.94s/it] 20%|██        | 45/221 [02:54<11:29,  3.92s/it] 21%|██        | 46/221 [02:58<11:29,  3.94s/it] 21%|██▏       | 47/221 [03:02<11:36,  4.00s/it] 22%|██▏       | 48/221 [03:06<11:36,  4.03s/it] 22%|██▏       | 49/221 [03:10<11:20,  3.95s/it] 23%|██▎       | 50/221 [03:14<10:59,  3.85s/it] 23%|██▎       | 51/221 [03:18<10:48,  3.82s/it] 24%|██▎       | 52/221 [03:22<10:57,  3.89s/it] 24%|██▍       | 53/221 [03:26<10:57,  3.91s/it] 24%|██▍       | 54/221 [03:30<10:57,  3.94s/it] 25%|██▍       | 55/221 [03:33<10:41,  3.86s/it] 25%|██▌       | 56/221 [03:37<10:35,  3.85s/it] 26%|██▌       | 57/221 [03:41<10:41,  3.91s/it] 26%|██▌       | 58/221 [03:45<10:50,  3.99s/it] 27%|██▋       | 59/221 [03:49<10:28,  3.88s/it] 27%|██▋       | 60/221 [03:53<10:19,  3.85s/it] 28%|██▊       | 61/221 [03:57<10:22,  3.89s/it] 28%|██▊       | 62/221 [04:01<10:18,  3.89s/it] 29%|██▊       | 63/221 [04:05<10:17,  3.91s/it] 29%|██▉       | 64/221 [04:08<10:05,  3.86s/it] 29%|██▉       | 65/221 [04:12<09:54,  3.81s/it] 30%|██▉       | 66/221 [04:16<09:56,  3.85s/it] 30%|███       | 67/221 [04:20<10:06,  3.94s/it] 31%|███       | 68/221 [04:24<09:54,  3.89s/it] 31%|███       | 69/221 [04:28<09:52,  3.90s/it] 32%|███▏      | 70/221 [04:32<09:45,  3.88s/it] 32%|███▏      | 71/221 [04:35<09:29,  3.80s/it] 33%|███▎      | 72/221 [04:39<09:24,  3.79s/it] 33%|███▎      | 73/221 [04:43<09:19,  3.78s/it] 33%|███▎      | 74/221 [04:47<09:34,  3.91s/it] 34%|███▍      | 75/221 [04:51<09:25,  3.88s/it] 34%|███▍      | 76/221 [04:55<09:16,  3.83s/it] 35%|███▍      | 77/221 [04:59<09:22,  3.91s/it] 35%|███▌      | 78/221 [05:02<09:16,  3.89s/it] 36%|███▌      | 79/221 [05:06<09:14,  3.90s/it] 36%|███▌      | 80/221 [05:10<09:02,  3.85s/it] 37%|███▋      | 81/221 [05:14<08:55,  3.82s/it] 37%|███▋      | 82/221 [05:18<08:55,  3.85s/it] 38%|███▊      | 83/221 [05:21<08:40,  3.78s/it] 38%|███▊      | 84/221 [05:25<08:35,  3.76s/it] 38%|███▊      | 85/221 [05:29<08:26,  3.72s/it] 39%|███▉      | 86/221 [05:33<08:31,  3.79s/it] 39%|███▉      | 87/221 [05:37<08:28,  3.80s/it] 40%|███▉      | 88/221 [05:40<08:29,  3.83s/it] 40%|████      | 89/221 [05:44<08:19,  3.78s/it] 41%|████      | 90/221 [05:48<08:25,  3.86s/it] 41%|████      | 91/221 [05:52<08:10,  3.77s/it] 42%|████▏     | 92/221 [05:56<08:17,  3.85s/it] 42%|████▏     | 93/221 [06:00<08:38,  4.05s/it] 43%|████▎     | 94/221 [06:04<08:36,  4.07s/it] 43%|████▎     | 95/221 [06:08<08:28,  4.04s/it] 43%|████▎     | 96/221 [06:12<08:23,  4.03s/it] 44%|████▍     | 97/221 [06:16<08:24,  4.07s/it] 44%|████▍     | 98/221 [06:20<08:13,  4.01s/it] 45%|████▍     | 99/221 [06:24<08:02,  3.95s/it] 45%|████▌     | 100/221 [06:28<07:52,  3.90s/it] 46%|████▌     | 101/221 [06:32<07:46,  3.89s/it] 46%|████▌     | 102/221 [06:36<07:41,  3.88s/it] 47%|████▋     | 103/221 [06:39<07:30,  3.81s/it] 47%|████▋     | 104/221 [06:43<07:32,  3.87s/it] 48%|████▊     | 105/221 [06:47<07:30,  3.88s/it] 48%|████▊     | 106/221 [06:51<07:28,  3.90s/it] 48%|████▊     | 107/221 [06:55<07:16,  3.83s/it] 49%|████▉     | 108/221 [06:59<07:13,  3.84s/it] 49%|████▉     | 109/221 [07:03<07:12,  3.86s/it] 50%|████▉     | 110/221 [07:07<07:16,  3.94s/it] 50%|█████     | 111/221 [07:11<07:12,  3.93s/it] 51%|█████     | 112/221 [07:15<07:05,  3.91s/it] 51%|█████     | 113/221 [07:18<07:00,  3.89s/it] 52%|█████▏    | 114/221 [07:22<06:59,  3.92s/it] 52%|█████▏    | 115/221 [07:26<06:55,  3.92s/it] 52%|█████▏    | 116/221 [07:30<06:51,  3.92s/it] 53%|█████▎    | 117/221 [07:34<06:48,  3.93s/it] 53%|█████▎    | 118/221 [07:38<06:38,  3.87s/it] 54%|█████▍    | 119/221 [07:42<06:46,  3.99s/it] 54%|█████▍    | 120/221 [07:46<06:37,  3.94s/it] 55%|█████▍    | 121/221 [07:50<06:35,  3.95s/it] 55%|█████▌    | 122/221 [07:54<06:27,  3.92s/it] 56%|█████▌    | 123/221 [07:58<06:20,  3.88s/it] 56%|█████▌    | 124/221 [08:01<06:14,  3.86s/it] 57%|█████▋    | 125/221 [08:05<06:14,  3.90s/it] 57%|█████▋    | 126/221 [08:09<06:03,  3.82s/it] 57%|█████▋    | 127/221 [08:13<06:03,  3.87s/it] 58%|█████▊    | 128/221 [08:17<05:57,  3.85s/it] 58%|█████▊    | 129/221 [08:21<05:57,  3.88s/it] 59%|█████▉    | 130/221 [08:25<05:53,  3.89s/it] 59%|█████▉    | 131/221 [08:29<05:49,  3.89s/it] 60%|█████▉    | 132/221 [08:32<05:40,  3.82s/it] 60%|██████    | 133/221 [08:36<05:39,  3.86s/it] 61%|██████    | 134/221 [08:40<05:38,  3.89s/it] 61%|██████    | 135/221 [08:44<05:26,  3.80s/it] 62%|██████▏   | 136/221 [08:48<05:31,  3.90s/it] 62%|██████▏   | 137/221 [08:52<05:23,  3.85s/it] 62%|██████▏   | 138/221 [08:56<05:22,  3.89s/it] 63%|██████▎   | 139/221 [08:59<05:16,  3.86s/it] 63%|██████▎   | 140/221 [09:03<05:18,  3.93s/it] 64%|██████▍   | 141/221 [09:07<05:12,  3.91s/it] 64%|██████▍   | 142/221 [09:11<05:09,  3.92s/it] 65%|██████▍   | 143/221 [09:15<05:10,  3.98s/it] 65%|██████▌   | 144/221 [09:19<05:06,  3.98s/it] 66%|██████▌   | 145/221 [09:23<05:03,  4.00s/it] 66%|██████▌   | 146/221 [09:27<05:01,  4.02s/it] 67%|██████▋   | 147/221 [09:31<04:56,  4.00s/it] 67%|██████▋   | 148/221 [09:35<04:51,  3.99s/it] 67%|██████▋   | 149/221 [09:39<04:45,  3.96s/it] 68%|██████▊   | 150/221 [09:43<04:32,  3.84s/it] 68%|██████▊   | 151/221 [09:47<04:28,  3.83s/it] 69%|██████▉   | 152/221 [09:51<04:26,  3.86s/it] 69%|██████▉   | 153/221 [09:55<04:23,  3.88s/it] 70%|██████▉   | 154/221 [09:58<04:17,  3.84s/it] 70%|███████   | 155/221 [10:02<04:12,  3.82s/it] 71%|███████   | 156/221 [10:06<04:06,  3.79s/it] 71%|███████   | 157/221 [10:10<04:06,  3.85s/it] 71%|███████▏  | 158/221 [10:13<04:00,  3.81s/it] 72%|███████▏  | 159/221 [10:17<03:57,  3.82s/it] 72%|███████▏  | 160/221 [10:21<03:49,  3.76s/it] 73%|███████▎  | 161/221 [10:25<03:47,  3.79s/it] 73%|███████▎  | 162/221 [10:29<03:46,  3.84s/it] 74%|███████▍  | 163/221 [10:33<03:43,  3.85s/it] 74%|███████▍  | 164/221 [10:36<03:39,  3.85s/it] 75%|███████▍  | 165/221 [10:40<03:32,  3.79s/it] 75%|███████▌  | 166/221 [10:44<03:31,  3.85s/it] 76%|███████▌  | 167/221 [10:48<03:27,  3.84s/it] 76%|███████▌  | 168/221 [10:52<03:24,  3.85s/it] 76%|███████▋  | 169/221 [10:55<03:15,  3.77s/it] 77%|███████▋  | 170/221 [11:00<03:19,  3.91s/it] 77%|███████▋  | 171/221 [11:03<03:12,  3.85s/it] 78%|███████▊  | 172/221 [11:07<03:10,  3.88s/it] 78%|███████▊  | 173/221 [11:11<03:07,  3.90s/it] 79%|███████▊  | 174/221 [11:15<03:06,  3.96s/it] 79%|███████▉  | 175/221 [11:19<02:59,  3.90s/it] 80%|███████▉  | 176/221 [11:23<02:54,  3.88s/it] 80%|████████  | 177/221 [11:27<02:48,  3.83s/it] 81%|████████  | 178/221 [11:30<02:44,  3.82s/it] 81%|████████  | 179/221 [11:35<02:44,  3.91s/it] 81%|████████▏ | 180/221 [11:39<02:41,  3.94s/it] 82%|████████▏ | 181/221 [11:42<02:36,  3.92s/it] 82%|████████▏ | 182/221 [11:46<02:30,  3.87s/it] 83%|████████▎ | 183/221 [11:50<02:27,  3.87s/it] 83%|████████▎ | 184/221 [11:54<02:25,  3.93s/it] 84%|████████▎ | 185/221 [11:58<02:20,  3.91s/it] 84%|████████▍ | 186/221 [12:02<02:15,  3.88s/it] 85%|████████▍ | 187/221 [12:06<02:11,  3.86s/it] 85%|████████▌ | 188/221 [12:09<02:07,  3.86s/it] 86%|████████▌ | 189/221 [12:13<02:02,  3.84s/it] 86%|████████▌ | 190/221 [12:17<01:58,  3.83s/it] 86%|████████▋ | 191/221 [12:21<01:56,  3.88s/it] 87%|████████▋ | 192/221 [12:25<01:53,  3.90s/it] 87%|████████▋ | 193/221 [12:29<01:48,  3.87s/it] 88%|████████▊ | 194/221 [12:33<01:44,  3.86s/it] 88%|████████▊ | 195/221 [12:37<01:40,  3.87s/it] 89%|████████▊ | 196/221 [12:41<01:41,  4.07s/it] 89%|████████▉ | 197/221 [12:45<01:35,  4.00s/it] 90%|████████▉ | 198/221 [12:49<01:31,  3.99s/it] 90%|█████████ | 199/221 [12:53<01:27,  3.99s/it] 90%|█████████ | 200/221 [12:57<01:22,  3.94s/it] 91%|█████████ | 201/221 [13:00<01:17,  3.87s/it] 91%|█████████▏| 202/221 [13:04<01:13,  3.87s/it] 92%|█████████▏| 203/221 [13:08<01:10,  3.94s/it] 92%|█████████▏| 204/221 [13:12<01:05,  3.86s/it] 93%|█████████▎| 205/221 [13:16<01:01,  3.87s/it] 93%|█████████▎| 206/221 [13:20<00:58,  3.90s/it] 94%|█████████▎| 207/221 [13:24<00:54,  3.91s/it] 94%|█████████▍| 208/221 [13:28<00:51,  3.92s/it] 95%|█████████▍| 209/221 [13:32<00:46,  3.91s/it] 95%|█████████▌| 210/221 [13:36<00:43,  3.97s/it] 95%|█████████▌| 211/221 [13:40<00:39,  3.92s/it] 96%|█████████▌| 212/221 [13:44<00:35,  3.92s/it] 96%|█████████▋| 213/221 [13:47<00:31,  3.89s/it] 97%|█████████▋| 214/221 [13:51<00:27,  3.90s/it] 97%|█████████▋| 215/221 [13:55<00:23,  3.90s/it] 98%|█████████▊| 216/221 [13:59<00:19,  3.90s/it] 98%|█████████▊| 217/221 [14:03<00:15,  3.93s/it] 99%|█████████▊| 218/221 [14:07<00:12,  4.01s/it] 99%|█████████▉| 219/221 [14:11<00:08,  4.02s/it]100%|█████████▉| 220/221 [14:15<00:04,  4.03s/it]100%|██████████| 221/221 [14:20<00:00,  4.17s/it]100%|██████████| 221/221 [14:20<00:00,  3.89s/it]
***************************************************************

Test results

 -- Single channel results (no combination of channels) --

Test accuracy : 0.5674120815698346
Test macro f1-score : 0.5129598409738503
Confussion matrix:
[[146483 126205]
 [ 14332  37855]]

Classification report:
              precision    recall  f1-score   support

         0.0       0.91      0.54      0.68    272688
         1.0       0.23      0.73      0.35     52187

    accuracy                           0.57    324875
   macro avg       0.57      0.63      0.51    324875
weighted avg       0.80      0.57      0.62    324875


--------------------------------------------------------------

 -- All channels involved (combined for each timestamp) --

Test accuracy : 0.5987256637168141
Test macro f1-score : 0.5557987421115653
Confussion matrix:
[[6424 5432]
 [ 236 2033]]

Classification report:
              precision    recall  f1-score   support

         0.0       0.96      0.54      0.69     11856
         1.0       0.27      0.90      0.42      2269

    accuracy                           0.60     14125
   macro avg       0.62      0.72      0.56     14125
weighted avg       0.85      0.60      0.65     14125


--------------------------------------------------------------

Num seizures: 1
Global metrics after inference


Accuracy of the sliding window: 58.5636
Percentage of detected seizures: 100.0000
Average latency: 9.5 seconds
False Alarms per Hour: 0.01161061946902655
***************************************************************


